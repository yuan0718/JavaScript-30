<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>Speech Synthesis</title>
		<link
			href="https://fonts.googleapis.com/css?family=Pacifico"
			rel="stylesheet"
			type="text/css"
		/>
		<link rel="stylesheet" href="style.css" />
	</head>
	<body>
		<div class="voiceinator">
			<h1>The Voiceinator 5000</h1>

			<select name="voice" id="voices">
				<option value="">Select A Voice</option>
			</select>

			<label for="rate">Rate:</label>
			<input name="rate" type="range" min="0" max="3" value="1" step="0.1" />

			<label for="pitch">Pitch:</label>

			<input name="pitch" type="range" min="0" max="2" step="0.1" />
			<textarea name="text">Hello! I love JavaScript üëç</textarea>
			<button id="stop">Stop!</button>
			<button id="speak">Speak</button>
		</div>

		<script>
			// ÊñáÂ≠óË≠òÂà•Â∞çË±° SpeechSynthesisUtterance()
			const voiceMsg = new SpeechSynthesisUtterance();
			voiceMsg.text = document.querySelector('textarea').value;
			let voices = [];
			const stopButton = document.querySelector('#stop');
			const speakButton = document.querySelector('#speak');
			const voicesDropdown = document.querySelector('#voices');
			const options = document.querySelectorAll('[type="range"],[name="text"]');
			// ÊéßÂà∂ÊñáÂ≠óË≠òÂà•Ë™ûÈü≥Êí≠Êîæ
			const toggle = function (startSpeak = true) {
				if (startSpeak) {
					// ÊñáÂ≠óË≠òÂà•Ë™ûÈü≥Êí≠Êîæ
					speechSynthesis.speak(voiceMsg);
				} else {
					// ÂèñÊ∂àÊñáÂ≠óË≠òÂà•Ë™ûÈü≥
					speechSynthesis.cancel(voiceMsg);
				}
			};
			// Áç≤Âèñ Ë™ûÈü≥ÂºïÊìéÁ®ÆÈ°û
			const showVoices = function () {
				// getVoices Ë™ûÈü≥ÂºïÊìéÁ®ÆÈ°û
				voices = this.getVoices();
				const optionHTML = voices
					.map((voice) => {
						return `
          <option value="${voice.lang}">${voice.name}(${voice.lang})</option>
          `;
					})
					.join('');
				voicesDropdown.innerHTML = optionHTML;
			};
			//  ÊîπËÆäË™ûÈü≥ÂºïÊìéÁ®ÆÈ°û
			const setVoices = function () {
				voiceMsg.voice = voices.find((voice) => voice.lang === this.value);
				toggle();
			};
      // ÊîπËÆä Èü≥Ë™ø Ë™ûÈÄü ÊñáÂ≠óÂÖßÂÆπ
			const setOption = function () {
				voiceMsg[this.name] = this.value;
				toggle();
			};
			speakButton.addEventListener('click', toggle);
			stopButton.addEventListener('click', () => toggle(false));
			// Ë™ûÈü≥ÂºïÊìéÁ®ÆÈ°û ÊîπËÆäËß∏Áôº
			speechSynthesis.addEventListener('voiceschanged', showVoices);
			voicesDropdown.addEventListener('change', setVoices);
			options.forEach((option) => option.addEventListener('change', setOption));
		</script>
	</body>
</html>
